# åŸºäºæœ€å¤§ç†µåŸç†çš„æ•°å­¦æ¨ç†ç³»ç»Ÿ - é¡¹ç›®å·¥ä½œæµç¨‹æ–‡æ¡£

> **é¡¹ç›®åç§°**: Entropy-Guided Reasoning (EGR)  
> **æ ¸å¿ƒåˆ›æ–°**: å°†æœ€å¤§ç†µåŸç†ç³»ç»ŸåŒ–åº”ç”¨äºè‡ªåŠ¨æ•°å­¦æ¨ç†  
> **ç›®æ ‡æ•°æ®é›†**: Conic10K  
> **ç›®æ ‡å‡†ç¡®ç‡**: 60-80% (Phase 1)

---

## ğŸ“Š ç³»ç»Ÿæ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è¾“å…¥ï¼šæ•°å­¦é—®é¢˜                              â”‚
â”‚   fact_expressions + query_expressions + answer              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨¡å—1: çŠ¶æ€æ„é€ å™¨ (State Constructor)                        â”‚
â”‚  â”œâ”€ è¾“å…¥: fact_expressions, query_expressions               â”‚
â”‚  â”œâ”€ è¾“å‡ºå±‚1: SymbolicState (ç¬¦å·çŠ¶æ€ - ç»†ç²’åº¦)               â”‚
â”‚  â””â”€ è¾“å‡ºå±‚2: AbstractState (æŠ½è±¡çŠ¶æ€ - ç²—ç²’åº¦)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨¡å—2: å®šç†é€‰æ‹©å™¨ (Theorem Selector)                         â”‚
â”‚  â”œâ”€ è¾“å…¥: AbstractState                                      â”‚
â”‚  â”œâ”€ æ¨¡å‹: P(Y|X) - ç¥ç»ç½‘ç»œåˆ†ç±»å™¨ (æœ€å¤§ç†µåŸç†)                â”‚
â”‚  â””â”€ è¾“å‡º: å®šç†æ¦‚ç‡åˆ†å¸ƒ P(Y|X) + é¢„æµ‹ç†µ H(Y|X)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨¡å—3: å®šç†åº”ç”¨å™¨ (Theorem Applicator)                       â”‚
â”‚  â”œâ”€ è¾“å…¥: SymbolicState + é€‰å®šå®šç†                           â”‚
â”‚  â”œâ”€ å®šç†åº“: 80ä¸ªå½¢å¼åŒ–å®šç†æ¨¡å‹                                â”‚
â”‚  â””â”€ è¾“å‡º: æ›´æ–°åçš„ SymbolicState                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨¡å—4: æ¨ç†å¼•æ“ (Reasoning Engine)                           â”‚
â”‚  â”œâ”€ ç­–ç•¥: ç»¼åˆè¯„åˆ† = Î»â‚Â·P(Y|X) + Î»â‚‚Â·InfoGain - Î»â‚ƒÂ·H(Y|X)    â”‚
â”‚  â”œâ”€ å¾ªç¯: çŠ¶æ€æ„é€  â†’ å®šç†é€‰æ‹© â†’ å®šç†åº”ç”¨ â†’ çŠ¶æ€æ›´æ–°...        â”‚
â”‚  â””â”€ è¾“å‡º: æœ€ç»ˆç­”æ¡ˆ + æ¨ç†è·¯å¾„ + ç†µå˜åŒ–è½¨è¿¹                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                è¾“å‡ºï¼šé¢„æµ‹ç­”æ¡ˆ + æ¨ç†æ­¥éª¤                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ä¸»è¦å·¥ä½œæ¨¡å—è¯¦è§£

---

### **æ¨¡å— 0: å®šç†æ¨¡å‹åº“æ„å»º** 

**å·¥ä½œç›®æ ‡**: å®ç°Conic10Kæ•°æ®é›†ä¸­80ä¸ªå½¢å¼åŒ–å®šç†æ¨¡å‹

#### ğŸ“ å·¥ä½œæµç¨‹

1. **æ¨¡å‹æ˜ å°„ä¸åˆ†æ**
   - åŸºäº`model/conic_model_ids.json`è·å–80ä¸ªæ¨¡å‹ID
   - ä»`model/conic_model_descriptions.md`æå–æ¯ä¸ªæ¨¡å‹çš„è¯¦ç»†è¯´æ˜
   - åˆ†ææ¨¡å‹åœ¨è®­ç»ƒé›†ä¸­çš„ä½¿ç”¨é¢‘ç‡å’Œç»„åˆæ¨¡å¼

2. **æ¨¡å‹å½¢å¼åŒ–**
   - å®šä¹‰æ¯ä¸ªæ¨¡å‹çš„`can_apply()`å‰ç½®æ¡ä»¶æ£€æŸ¥
   - å®šä¹‰æ¯ä¸ªæ¨¡å‹çš„`apply()`çŠ¶æ€è½¬æ¢å‡½æ•°
   - ä½¿ç”¨`model/object.json`å’Œ`model/operators.json`è§£æfact_expressions

3. **æ¨¡å‹å®ç°**
   - å®ç°80ä¸ªæ¨¡å‹ç±»ï¼Œæ¯ä¸ªæ¨¡å‹åŒ…å«ï¼š
     - `can_apply(symbolic_state) -> bool`
     - `apply(symbolic_state) -> None`  # ç›´æ¥ä¿®æ”¹çŠ¶æ€
   - æŒ‰å¤æ‚åº¦åˆ†ç±»ï¼ˆç®€å•/ä¸­ç­‰/å¤æ‚ï¼‰
   - ç¼–å†™å•å…ƒæµ‹è¯•

4. **å®šç†åº“å°è£…**
   - å®ç°`TheoremLibrary`ç±»ç®¡ç†80ä¸ªæ¨¡å‹
   - æä¾›`get_model(model_id)`æ¥å£
   - æä¾›`apply_model_sequence()`æ‰¹é‡åº”ç”¨æ¥å£

#### ğŸ“¥ è¾“å…¥
- **æ¨¡å‹å®šä¹‰**: `model/conic_model_descriptions.md` (80ä¸ªæ¨¡å‹)
- **æ¨¡å‹IDæ˜ å°„**: `model/conic_model_ids.json`
- **å¯¹è±¡å®šä¹‰**: `model/object.json`
- **æ“ä½œç¬¦å®šä¹‰**: `model/operators.json`
- **è®­ç»ƒæ•°æ®**: `data/train_with_models_v2.json` (å«modelså­—æ®µ)

#### ğŸ“¤ è¾“å‡º
```python
class TheoremModel:
    def can_apply(self, symbolic_state: SymbolicState) -> bool:
        """æ£€æŸ¥æ¨¡å‹æ˜¯å¦å¯åº”ç”¨"""
        pass
    
    def apply(self, symbolic_state: SymbolicState) -> None:
        """åº”ç”¨æ¨¡å‹ï¼Œç›´æ¥ä¿®æ”¹symbolic_state"""
        pass

class TheoremLibrary:
    def __init__(self):
        self.models = {}  # 80ä¸ªæ¨¡å‹
    
    def get_model(self, model_id: int) -> TheoremModel:
        """æ ¹æ®IDè·å–æ¨¡å‹"""
        pass
```

#### âœ… éªŒæ”¶æ ‡å‡†
- [ ] 80ä¸ªæ¨¡å‹å…¨éƒ¨å®ç°
- [ ] æ¯ä¸ªæ¨¡å‹æœ‰å®Œæ•´çš„å‰ç½®æ¡ä»¶æ£€æŸ¥
- [ ] æ¯ä¸ªæ¨¡å‹èƒ½æ­£ç¡®æ›´æ–°SymbolicState
- [ ] èƒ½å¤Ÿå¤„ç†`train_with_models_v2.json`ä¸­çš„æ¨¡å‹åºåˆ—

#### â±ï¸ é¢„è®¡æ—¶é—´
**2-3å‘¨** (æŒ‰ç®€å•â†’å¤æ‚åˆ†æ‰¹å®ç°)

#### ğŸ“‚ ä»£ç æ–‡ä»¶
- `src/theorems/theorem_library.py`
- `src/theorems/models/` (80ä¸ªæ¨¡å‹å®ç°)
- `tests/test_theorem_library.py`

#### ğŸ“– å‚è€ƒæ–‡æ¡£
- `doc/module0_model_library.md` - è¯¦ç»†å¼€å‘æŒ‡å—

---

### **æ¨¡å— 1: çŠ¶æ€æ„é€ å™¨ (State Constructor)**

**å·¥ä½œç›®æ ‡**: æ„å»ºåŒå±‚çŠ¶æ€è¡¨ç¤ºï¼ˆSymbolicState + AbstractStateï¼‰

#### ğŸ“ å·¥ä½œæµç¨‹

1. **SymbolicState æ„å»º**ï¼ˆç»†ç²’åº¦ï¼‰
   - è§£æ`fact_expressions`å­—ç¬¦ä¸²
   - æå–å®ä½“ï¼ˆentitiesï¼‰ï¼šå¦‚ `G: Hyperbola`, `F1: Point`
   - æå–æ–¹ç¨‹ï¼ˆequationsï¼‰ï¼šå¦‚ `Expression(G) = (x^2/4 - y^2/9 = 1)`
   - æå–å‚æ•°ï¼ˆparametersï¼‰ï¼šå¦‚ `a=2`, `b=3`
   - æå–å‡ ä½•å…³ç³»ï¼ˆgeometric_relationsï¼‰ï¼šå¦‚ `LeftFocus(G) = F1`
   - æå–åæ ‡ä¿¡æ¯ï¼ˆcoordinatesï¼‰ï¼šå¦‚ `Coordinate(P) = (1, 2)`

2. **AbstractState æ„å»º**ï¼ˆç²—ç²’åº¦ï¼‰
   - ä»SymbolicStateæå–æŠ½è±¡ç‰¹å¾ï¼š
     - `curve_type`: æ›²çº¿ç±»å‹ (4ç§)
     - `query_type`: æŸ¥è¯¢ç±»å‹ (8ç§)
     - `has_equation`: æ˜¯å¦æœ‰æ–¹ç¨‹
     - `has_parameters`: å·²çŸ¥å‚æ•°é›†åˆ
     - 11ä¸ªä¿¡æ¯ç‰¹å¾ï¼ˆfocus/vertex/asymptoteç­‰ï¼‰
     - `completeness_score`: å®Œæ•´åº¦è¯„åˆ† (0-1)
     - `reasoning_depth`: æ¨ç†æ·±åº¦

3. **çŠ¶æ€æ›´æ–°æœºåˆ¶**
   - æ¨¡å‹åº”ç”¨åç›´æ¥ä¿®æ”¹SymbolicState
   - ä»æ›´æ–°åçš„SymbolicStateé‡æ–°æ„å»ºAbstractState
   - æ·±åº¦è‡ªåŠ¨é€’å¢

4. **éªŒè¯ä¸ç»Ÿè®¡**
   - éªŒè¯çŠ¶æ€åºåˆ—æ„å»ºçš„æ­£ç¡®æ€§
   - ç»Ÿè®¡çŠ¶æ€ç‰¹å¾åˆ†å¸ƒ

#### ğŸ“¥ è¾“å…¥
```python
{
    "fact_expressions": "G: Hyperbola; Expression(G) = (x^2/4 - y^2/9 = 1); m: Number; ...",
    "query_expressions": "m"
}
```

#### ğŸ“¤ è¾“å‡º
```python
# SymbolicState (ç»†ç²’åº¦ - ç”¨äºæ¨¡å‹åº”ç”¨)
{
    "entities": {
        "G": {"type": "Hyperbola"},
        "m": {"type": "Number"}
    },
    "equations": [
        "Expression(G) = (x^2/4 - y^2/9 = 1)"
    ],
    "parameters": {"a": "2", "b": "3"},
    "geometric_relations": ["LeftFocus(G) = F1"],
    "coordinates": {},
    "query_expressions": "m"
}

# AbstractState (ç²—ç²’åº¦ - ç”¨äºç¥ç»ç½‘ç»œ)
{
    "curve_type": CurveType.HYPERBOLA,
    "query_type": QueryType.VALUE,
    "has_equation": True,
    "has_parameters": {"a", "b"},
    "has_focus_info": True,
    "completeness_score": 0.65,
    "reasoning_depth": 0
}
```

#### âœ… éªŒæ”¶æ ‡å‡†
- [ ] èƒ½æ­£ç¡®è§£æ95%ä»¥ä¸Šçš„fact_expressions
- [ ] SymbolicStateåŒ…å«å®Œæ•´çš„ç¬¦å·ä¿¡æ¯
- [ ] AbstractStateçš„15ç»´ç‰¹å¾å®šä¹‰æ¸…æ™°
- [ ] çŠ¶æ€æ›´æ–°é€»è¾‘æ­£ç¡®ï¼ˆåº”ç”¨æ¨¡å‹åèƒ½æ­£ç¡®æ›´æ–°ï¼‰
- [ ] completeness_scoreåˆç†ï¼ˆä¸æ¨ç†è¿›åº¦ç›¸å…³ï¼‰

#### â±ï¸ é¢„è®¡æ—¶é—´
**1.5-2å‘¨**

#### ğŸ“‚ ä»£ç æ–‡ä»¶
- `src/state_constructor.py` (åŸ state_abstractor.py)
- `tests/test_state_constructor.py`
- `tests/test_integration_state_theorem.py`

#### ğŸ“– å‚è€ƒæ–‡æ¡£
- `doc/module1_state_construct.md` - è¯¦ç»†å¼€å‘æŒ‡å—

---

### **æ¨¡å— 2: è®­ç»ƒæ•°æ®æ„é€ å™¨**

**å·¥ä½œç›®æ ‡**: ä»Conic10Kæ„é€ çŠ¶æ€åºåˆ—ï¼Œç”Ÿæˆè®­ç»ƒæ ·æœ¬

#### ğŸ“ å·¥ä½œæµç¨‹

1. **æ¨¡å‹åºåˆ—å¤„ç†**
   - ä½¿ç”¨`train_with_models_v2.json`ï¼ˆå·²æœ‰modelså­—æ®µï¼‰
   - æ¯ä¸ªæ ·æœ¬åŒ…å«å®Œæ•´çš„æ¨¡å‹IDåºåˆ—
   - æ— éœ€å†è§£æ`process`è‡ªç„¶è¯­è¨€

2. **çŠ¶æ€åºåˆ—æ„å»º**
   - S0: ä»`fact_expressions`æ„å»ºåˆå§‹çŠ¶æ€
   - S1, S2, ...: é€æ­¥åº”ç”¨modelsåºåˆ—ä¸­çš„æ¨¡å‹
   - æ¯ä¸€æ­¥ç”Ÿæˆ`(SymbolicState, AbstractState)`å¯¹
   - å®Œæ•´åºåˆ—ï¼š`[(S0, s0), (S1, s1), ..., (Sn, sn)]`

3. **è®­ç»ƒæ ·æœ¬ç”Ÿæˆ**
   - ä»çŠ¶æ€åºåˆ—æå–è®­ç»ƒæ ·æœ¬ï¼š
     - è¾“å…¥ï¼šAbstractState(t)
     - æ ‡ç­¾ï¼šmodel_id(t), completeness_score(t)
   - ç†µæ ‡ç­¾ï¼š`H(S) = 1 - completeness_score`ï¼ˆå¯å‘å¼ï¼‰
   - æˆ–ä½¿ç”¨å‰©ä½™æ­¥æ•°å½’ä¸€åŒ–ä½œä¸ºç†µæ ‡ç­¾

4. **æ•°æ®å¢å¼º**ï¼ˆå¯é€‰ï¼‰
   - ç”Ÿæˆè´Ÿæ ·æœ¬ï¼ˆä¸å¯åº”ç”¨çš„æ¨¡å‹ï¼‰
   - æ•°æ®å¹³è¡¡ï¼ˆè¿‡é‡‡æ ·ä½é¢‘æ¨¡å‹ï¼‰

#### ğŸ“¥ è¾“å…¥
```python
{
    "id": 2,
    "fact_expressions": "G: Hyperbola; Expression(G) = (x^2/4 - y^2/m^2 = 1); ...",
    "query_expressions": "m",
    "models": [5, 21],  # æ¨¡å‹åºåˆ—
    "answer_expressions": "5"
}
```

#### ğŸ“¤ è¾“å‡º
```python
[
    {
        "abstract_state": AbstractState(...),  # S0
        "model_label": 5,                      # ä¸‹ä¸€æ­¥åº”ç”¨çš„æ¨¡å‹
        "entropy_label": 0.7,                  # H(S0) = 1 - 0.3
        "completeness": 0.3,
        "reasoning_depth": 0
    },
    {
        "abstract_state": AbstractState(...),  # S1
        "model_label": 21,
        "entropy_label": 0.3,                  # H(S1) = 1 - 0.7
        "completeness": 0.7,
        "reasoning_depth": 1
    },
    ...
]
```

#### âœ… éªŒæ”¶æ ‡å‡†
- [ ] æˆåŠŸæ„å»ºæ‰€æœ‰è®­ç»ƒé›†æ ·æœ¬çš„çŠ¶æ€åºåˆ—
- [ ] è®­ç»ƒæ ·æœ¬æ€»æ•°ï¼š50,000+ 
- [ ] éªŒè¯é›†æ ·æœ¬ï¼š10,000+
- [ ] æ¨¡å‹æ ‡ç­¾è¦†ç›–80ä¸ªæ¨¡å‹ï¼ˆéƒ¨åˆ†ä½é¢‘æ¨¡å‹å¯èƒ½è¾ƒå°‘ï¼‰
- [ ] ç†µæ ‡ç­¾åˆç†æ€§æ£€æŸ¥é€šè¿‡

#### â±ï¸ é¢„è®¡æ—¶é—´
**1-1.5å‘¨** (åŸºäºç°æœ‰modelså­—æ®µï¼Œæ— éœ€è§£æprocess)

#### ğŸ“‚ ä»£ç æ–‡ä»¶
- `scripts/data/build_state_sequences.py`
- `src/data_constructor.py`
- `tests/test_data_constructor.py`

---

### **æ¨¡å— 3: ç¥ç»ç½‘ç»œæ¨¡å‹ï¼ˆæœ€å¤§ç†µåŸç†å®ç°ï¼‰**

**å·¥ä½œç›®æ ‡**: è®­ç»ƒå¤šä»»åŠ¡å­¦ä¹ æ¨¡å‹ï¼Œå®ç°ä¸‰ä¸ªæ¦‚ç‡/ç†µè®¡ç®—

#### ğŸ“ å·¥ä½œæµç¨‹

1. **æ¨¡å‹æ¶æ„è®¾è®¡**
   - **è¾“å…¥ç¼–ç å™¨**ï¼šå°†AbstractState(15ç»´ç‰¹å¾)è½¬æ¢ä¸ºåµŒå…¥
     - Curve type embedding (4ç»´)
     - Query type embedding (8ç»´)
     - Binary features (11ç»´)
     - Numerical features (completeness, depth)
   - **ä¸»å¹²ç½‘ç»œ**ï¼šTransformerç¼–ç å™¨æˆ–MLP
   - **è¾“å‡ºå¤´1**ï¼šæ¨¡å‹åˆ†ç±»å™¨ï¼ˆ80ç±»ï¼‰- è¾“å‡º P(Y|X)
   - **è¾“å‡ºå¤´2**ï¼šç†µå›å½’å™¨ï¼ˆ1ä¸ªæ•°å€¼ï¼‰- è¾“å‡º H(S)

2. **ä¸‰ä¸ªå…³é”®è®¡ç®—çš„å®ç°**

   **â‘  P(Y|X) - æ¨¡å‹é€‰æ‹©æ¦‚ç‡ï¼ˆæœ€å¤§ç†µåˆ†ç±»å™¨ï¼‰**
   ```python
   # è®­ç»ƒç›®æ ‡ï¼šæœ€å°åŒ–äº¤å‰ç†µæŸå¤±
   loss_P = CrossEntropyLoss(logits, true_model_id)
   # ç­‰ä»·äºï¼šæœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶ = æœ€å¤§ç†µå­¦ä¹ 
   
   # æ¨ç†æ—¶ï¼š
   P_Y_given_X = softmax(model.classifier_head(state))  # 80ç»´æ¦‚ç‡åˆ†å¸ƒ
   ```

   **â‘¡ H(S) - çŠ¶æ€ç†µä¼°è®¡**
   ```python
   # æ–¹æ³•A: å¯å‘å¼ä¼°è®¡ï¼ˆbaselineï¼‰
   H_S = 1 - completeness_score
   
   # æ–¹æ³•B: ç¥ç»ç½‘ç»œå›å½’ï¼ˆè®­ç»ƒï¼‰
   loss_H = MSELoss(pred_entropy, target_entropy)
   # target_entropy = 1 - completeness_score æˆ–å½’ä¸€åŒ–çš„å‰©ä½™æ­¥æ•°
   
   # æ¨ç†æ—¶ï¼š
   H_S = model.entropy_head(state)  # æ ‡é‡
   ```

   **â‘¢ H(Y|X) - é¢„æµ‹ç†µï¼ˆé€‰æ‹©ä¸ç¡®å®šæ€§ï¼‰**
   ```python
   # ç›´æ¥ä»P(Y|X)åˆ†å¸ƒè®¡ç®—ï¼ˆæ— éœ€è®­ç»ƒï¼‰
   H_Y_given_X = -sum(P_Y_given_X * log(P_Y_given_X))
   # ç†µè¶Šé«˜ï¼Œé¢„æµ‹è¶Šä¸ç¡®å®š
   ```

3. **è®­ç»ƒé…ç½®**
   - æŸå¤±å‡½æ•°ï¼š`Î»â‚Â·loss_P + Î»â‚‚Â·loss_H`
   - ä¼˜åŒ–å™¨ï¼šAdamW
   - å­¦ä¹ ç‡è°ƒåº¦ï¼šWarmup + Cosine Decay
   - æ‰¹å¤§å°ï¼š128
   - Epochï¼š50-100

4. **è®­ç»ƒç›‘æ§**
   - P(Y|X): Top-1/Top-3/Top-5å‡†ç¡®ç‡
   - H(S): MAE, MSE, ç›¸å…³ç³»æ•°
   - H(Y|X): å¹³å‡é¢„æµ‹ç†µï¼Œé«˜ç†µæ ·æœ¬åˆ†æ
   - éªŒè¯é›†æ€§èƒ½æ›²çº¿

#### ğŸ“¥ è¾“å…¥
```python
{
    "train_data": [
        {
            "abstract_state": AbstractState(...),  # 15ç»´ç‰¹å¾
            "model_label": 5,                      # æ ‡ç­¾ï¼šä¸‹ä¸€æ­¥æ¨¡å‹
            "entropy_label": 0.7                   # æ ‡ç­¾ï¼šH(S)
        },
        ...
    ],
    "val_data": [...]
}
```

#### ğŸ“¤ è¾“å‡º
```python
# è®­ç»ƒå¥½çš„æ¨¡å‹
model = MaxEntropyReasoner(
    num_models=80,
    d_model=256,
    num_layers=4
)

# æ¨ç†æ—¶è¾“å‡ºä¸‰ä¸ªå€¼
P_Y_given_X, H_S, H_Y_given_X = model.predict(abstract_state)

# å…·ä½“ï¼š
{
    "P_Y_given_X": [0.001, 0.003, ..., 0.58, ...],  # 80ç»´æ¦‚ç‡åˆ†å¸ƒ
    "H_S": 0.65,                                     # å½“å‰çŠ¶æ€ç†µ
    "H_Y_given_X": 1.2                               # é¢„æµ‹åˆ†å¸ƒçš„ç†µ
}
```

#### âœ… éªŒæ”¶æ ‡å‡†
- [ ] P(Y|X): Top-1å‡†ç¡®ç‡ > 60%ï¼ŒTop-3 > 75%
- [ ] H(S): MAE < 0.15ï¼Œä¸çœŸå®å®Œæ•´åº¦ç›¸å…³ç³»æ•° > 0.7
- [ ] H(Y|X): èƒ½æ­£ç¡®åæ˜ é¢„æµ‹ä¸ç¡®å®šæ€§
- [ ] æ¨¡å‹æ”¶æ•›ç¨³å®šï¼Œæ— è¿‡æ‹Ÿåˆ

#### â±ï¸ é¢„è®¡æ—¶é—´
**2-3å‘¨**

#### ğŸ“‚ ä»£ç æ–‡ä»¶
- `src/models/max_entropy_model.py`
- `src/models/state_encoder.py`
- `src/train.py`
- `configs/model_config.yaml`

#### ğŸ“– ç†è®ºåŸºç¡€
- äº¤å‰ç†µæŸå¤± = æœ€å¤§ç†µå­¦ä¹ ï¼ˆæ»¡è¶³ç»éªŒçº¦æŸä¸‹çš„æœ€å¤§ä¸ç¡®å®šæ€§ï¼‰
- ä¸‰å±‚æœ€å¤§ç†µåŸç†çš„å®ç°ï¼š
  1. **ç­–ç•¥å­¦ä¹ **: P(Y|X) - æœ€å¤§ç†µåˆ†ç±»
  2. **è·¯å¾„è§„åˆ’**: H(S) - ç†µä¼°è®¡ç”¨äºInfoGain
  3. **ç½®ä¿¡åŠ æƒ**: H(Y|X) - ä¸ç¡®å®šæ€§æƒ©ç½š

---

### **æ¨¡å— 4: å®šç†åº”ç”¨å™¨ä¸çŠ¶æ€æ›´æ–°**

**å·¥ä½œç›®æ ‡**: å®ç°æ¨¡å‹åº”ç”¨é€»è¾‘ï¼Œæ›´æ–°SymbolicStateå’ŒAbstractState

#### ğŸ“ å·¥ä½œæµç¨‹

1. **æ¨¡å‹åº”ç”¨**ï¼ˆç”±TheoremLibraryå®ç°ï¼‰
   - è°ƒç”¨`model.can_apply(symbolic_state)`æ£€æŸ¥å‰ç½®æ¡ä»¶
   - è°ƒç”¨`model.apply(symbolic_state)`ç›´æ¥ä¿®æ”¹çŠ¶æ€
   - æ¨¡å‹è´Ÿè´£æ›´æ–°entities/equations/parametersç­‰å­—æ®µ

2. **çŠ¶æ€æ›´æ–°æµç¨‹**
   ```python
   # æ­¥éª¤1: åº”ç”¨æ¨¡å‹ï¼ˆä¿®æ”¹SymbolicStateï¼‰
   model = theorem_library.get_model(model_id)
   model.apply(symbolic_state)  # ç›´æ¥ä¿®æ”¹
   
   # æ­¥éª¤2: é‡æ–°æ„å»ºAbstractState
   new_abstract = constructor.construct_from_symbolic_state(
       symbolic_state,
       query_expressions,
       reasoning_depth + 1
   )
   ```

3. **é›†æˆæ¥å£**
   - TheoremLibraryæä¾›æ¨¡å‹ç®¡ç†
   - StateConstructoræä¾›çŠ¶æ€æ„å»º
   - æ¨ç†å¼•æ“åè°ƒä¸¤è€…äº¤äº’

4. **éªŒè¯**
   - æ£€æŸ¥çŠ¶æ€æ›´æ–°çš„æ­£ç¡®æ€§
   - éªŒè¯completeness_scoreæ˜¯å¦å•è°ƒé€’å¢
   - éªŒè¯æ¨¡å‹åºåˆ—èƒ½å¦æˆåŠŸåº”ç”¨

#### ğŸ“¥ è¾“å…¥
```python
{
    "symbolic_state": SymbolicState(
        entities={"G": {"type": "Hyperbola"}, ...},
        equations=["Expression(G) = (x^2/4 - y^2/b^2 = 1)"],
        parameters={"a": "2"},
        ...
    ),
    "model_id": 5  # Hyperbola_Standard_Parameter_Extraction
}
```

#### ğŸ“¤ è¾“å‡º
```python
{
    "symbolic_state": SymbolicState(
        # æ›´æ–°åçš„çŠ¶æ€ï¼Œæ–°å¢äº†bå‚æ•°
        parameters={"a": "2", "b": "3"},
        ...
    ),
    "abstract_state": AbstractState(
        has_parameters={"a", "b"},  # æ›´æ–°
        completeness_score=0.7,     # æé«˜
        reasoning_depth=1,          # é€’å¢
        ...
    )
}
```

#### âœ… éªŒæ”¶æ ‡å‡†
- [ ] 80ä¸ªæ¨¡å‹çš„apply()æ–¹æ³•æ­£ç¡®å®ç°
- [ ] çŠ¶æ€æ›´æ–°é€»è¾‘æ­£ç¡®ï¼ˆSymbolicState â†’ AbstractStateï¼‰
- [ ] èƒ½æˆåŠŸå¤„ç†train_with_models_v2.jsonçš„æ¨¡å‹åºåˆ—
- [ ] çŠ¶æ€æ›´æ–°åcompleteness_scoreåˆç†å˜åŒ–
- [ ] é›†æˆæµ‹è¯•é€šè¿‡

#### â±ï¸ é¢„è®¡æ—¶é—´
**ä¸æ¨¡å—0ã€æ¨¡å—1å¹¶è¡Œå¼€å‘**

#### ğŸ“‚ ä»£ç æ–‡ä»¶
- `src/theorems/theorem_library.py`ï¼ˆæ¨¡å—0ï¼‰
- `src/state_constructor.py`ï¼ˆæ¨¡å—1ï¼‰
- `tests/test_integration_state_theorem.py`

#### ğŸ“– å…³é”®åŸåˆ™
- **SymbolicState**ç”±æ¨¡å‹ç›´æ¥ä¿®æ”¹ï¼ˆin-placeï¼‰
- **AbstractState**ä»SymbolicStateé‡æ–°æ„å»ºï¼ˆä¸ä¿®æ”¹ï¼‰
- ä¸¤å±‚çŠ¶æ€åˆ†å·¥æ˜ç¡®ï¼šç¬¦å·å±‚ç”¨äºæ¨ç†ï¼ŒæŠ½è±¡å±‚ç”¨äºç¥ç»ç½‘ç»œ

---

### **æ¨¡å— 5: æ¨ç†å¼•æ“ï¼ˆæœ€å¤§ç†µé©±åŠ¨æ¨ç†ï¼‰**

**å·¥ä½œç›®æ ‡**: é›†æˆæ‰€æœ‰æ¨¡å—ï¼Œå®ç°ç†µé©±åŠ¨çš„é—®é¢˜æ±‚è§£

#### ğŸ“ å·¥ä½œæµç¨‹

1. **åˆå§‹åŒ–**
   - æ„å»ºåˆå§‹çŠ¶æ€ï¼š`(symbolic_s0, abstract_s0) = constructor.construct_from_facts(...)`
   - è®¾ç½®æœ€å¤§æ¨ç†æ­¥æ•°ï¼ˆå¦‚10æ­¥ï¼‰
   - åˆå§‹åŒ–æ¨ç†è·¯å¾„è®°å½•

2. **ç†µé©±åŠ¨æ¨ç†å¾ªç¯**
   ```python
   for step in range(max_steps):
       # ===== 2.1 ç¥ç»ç½‘ç»œé¢„æµ‹ =====
       P_Y_given_X, H_S, H_Y_given_X = model(abstract_state)
       # P_Y_given_X: 80ä¸ªæ¨¡å‹çš„æ¦‚ç‡åˆ†å¸ƒ
       # H_S: å½“å‰çŠ¶æ€ç†µä¼°è®¡
       # H_Y_given_X: é¢„æµ‹åˆ†å¸ƒçš„ç†µï¼ˆä¸ç¡®å®šæ€§ï¼‰
       
       # ===== 2.2 å€™é€‰æ¨¡å‹è¯„ä¼°ï¼ˆæœ€å¤§ç†µåŸç†åº”ç”¨ï¼‰=====
       scores = []
       for model_id in range(80):
           # æ£€æŸ¥å‰ç½®æ¡ä»¶
           model = theorem_library.get_model(model_id)
           if not model.can_apply(symbolic_state):
               scores.append(-inf)
               continue
           
           # æ¨¡æ‹Ÿåº”ç”¨æ¨¡å‹
           next_symbolic = copy(symbolic_state)
           model.apply(next_symbolic)
           next_abstract = constructor.construct_from_symbolic_state(
               next_symbolic, query, depth+1
           )
           
           # ä¼°è®¡æ–°çŠ¶æ€ç†µ
           _, H_S_next, _ = model(next_abstract)
           
           # è®¡ç®—ä¿¡æ¯å¢ç›Š
           info_gain = H_S - H_S_next
           
           # ===== ç»¼åˆè¯„åˆ†ï¼ˆä¸‰å±‚æœ€å¤§ç†µåŸç†ï¼‰=====
           score = (
               Î»â‚ * P_Y_given_X[model_id] +  # å±‚1: æ¨¡å‹ç½®ä¿¡åº¦
               Î»â‚‚ * info_gain -                # å±‚2: ä¿¡æ¯å¢ç›Š
               Î»â‚ƒ * H_Y_given_X                # å±‚3: ä¸ç¡®å®šæ€§æƒ©ç½š
           )
           scores.append(score)
       
       # ===== 2.3 é€‰æ‹©æœ€ä¼˜æ¨¡å‹ =====
       best_model_id = argmax(scores)
       
       # ===== 2.4 åº”ç”¨æ¨¡å‹ï¼Œæ›´æ–°çŠ¶æ€ =====
       model = theorem_library.get_model(best_model_id)
       model.apply(symbolic_state)
       abstract_state = constructor.construct_from_symbolic_state(
           symbolic_state, query, step+1
       )
       
       # ===== 2.5 è®°å½•æ¨ç†è·¯å¾„ =====
       reasoning_path.append({
           "step": step+1,
           "model_id": best_model_id,
           "H_S": H_S,
           "info_gain": info_gain,
           "completeness": abstract_state.completeness_score
       })
       
       # ===== 2.6 æ£€æŸ¥æ˜¯å¦å®Œæˆ =====
       if abstract_state.completeness_score > 0.95:
           answer = extract_answer(symbolic_state, query)
           return answer, reasoning_path
   
   return None, reasoning_path  # å¤±è´¥
   ```

3. **ç­”æ¡ˆæå–**
   - ä»æœ€ç»ˆSymbolicStateä¸­æå–ç›®æ ‡å€¼
   - æ”¯æŒå¤šç§æŸ¥è¯¢ç±»å‹ï¼ˆå‚æ•°å€¼/æ–¹ç¨‹/åæ ‡ç­‰ï¼‰

4. **æ¨ç†åˆ†æ**
   - è®°å½•ç†µå˜åŒ–è½¨è¿¹ï¼š`[H(S0), H(S1), ..., H(Sn)]`
   - è®°å½•ä¿¡æ¯å¢ç›Šåºåˆ—ï¼š`[IGâ‚, IGâ‚‚, ..., IGâ‚™]`
   - è®°å½•æ¨¡å‹é€‰æ‹©ç½®ä¿¡åº¦

#### ğŸ“¥ è¾“å…¥
```python
{
    "fact_expressions": "G: Ellipse; Expression(G) = (x^2/4 + y^2/3 = 1)",
    "query_expressions": "Eccentricity(G)",
    "answer_expressions": "sqrt(3)/3"  # ä»…ç”¨äºéªŒè¯
}
```

#### ğŸ“¤ è¾“å‡º
```python
{
    "predicted_answer": "sqrt(3)/3",
    "is_correct": True,
    "num_steps": 3,
    
    "reasoning_path": [
        {
            "step": 1, 
            "model_id": 3,
            "model_name": "Ellipse_Standard_Parameter_Extraction",
            "H_S": 0.85,
            "info_gain": 0.35,
            "P_Y_X": 0.68,
            "H_Y_X": 1.2
        },
        {
            "step": 2,
            "model_id": 11,
            "model_name": "Ellipse_Focal_Distance",
            "H_S": 0.50,
            "info_gain": 0.40,
            ...
        },
        {
            "step": 3,
            "model_id": 13,
            "model_name": "Eccentricity_Formula",
            "H_S": 0.10,
            "info_gain": 0.40,
            ...
        }
    ],
    
    "entropy_trace": [0.85, 0.50, 0.10],      # H(S)çš„å˜åŒ–
    "info_gain_sequence": [0.35, 0.40, 0.40], # æ¯æ­¥çš„ä¿¡æ¯å¢ç›Š
    "completeness_trace": [0.15, 0.50, 0.90]  # å®Œæ•´åº¦çš„æå‡
}
```

#### âœ… éªŒæ”¶æ ‡å‡†
- [ ] æµ‹è¯•é›†å‡†ç¡®ç‡ > 60%ï¼ˆç›®æ ‡80%ï¼‰
- [ ] å¹³å‡æ¨ç†æ­¥æ•° < 6æ­¥
- [ ] ç†µå•è°ƒé€’å‡ç‡ > 90%ï¼ˆè¯æ˜ç†µå¼•å¯¼æœ‰æ•ˆï¼‰
- [ ] æ¨ç†è·¯å¾„å¯è§£é‡Š
- [ ] ä¿¡æ¯å¢ç›Šä¸æ¨ç†è´¨é‡æ­£ç›¸å…³

#### â±ï¸ é¢„è®¡æ—¶é—´
**1.5-2å‘¨**

#### ğŸ“‚ ä»£ç æ–‡ä»¶
- `src/reasoning_engine.py`
- `src/answer_extractor.py`
- `src/eval.py`

#### ğŸ“– æ ¸å¿ƒåˆ›æ–°ä½“ç°
æœ¬æ¨¡å—æ˜¯**ä¸‰å±‚æœ€å¤§ç†µåŸç†**çš„å®Œæ•´å®ç°ï¼š
1. **ç­–ç•¥å­¦ä¹ **: P(Y|X) æŒ‡å¯¼æ¨¡å‹é€‰æ‹©
2. **è·¯å¾„è§„åˆ’**: InfoGain = H(S_t) - H(S_{t+1}) æœ€å¤§åŒ–
3. **ç½®ä¿¡åŠ æƒ**: H(Y|X) æƒ©ç½šä¸ç¡®å®šé¢„æµ‹

---

### **æ¨¡å— 6: è¯„ä¼°ä¸åˆ†æ**

**å·¥ä½œç›®æ ‡**: åœ¨Conic10Kæµ‹è¯•é›†ä¸Šè¯„ä¼°ç³»ç»Ÿæ€§èƒ½ï¼Œåˆ†æç»“æœ

#### ğŸ“ å·¥ä½œæµç¨‹

1. **æ€§èƒ½è¯„ä¼°**
   - å‡†ç¡®ç‡è®¡ç®—
   - æŒ‰ç­”æ¡ˆç±»å‹åˆ†ç±»ç»Ÿè®¡
   - æŒ‰é—®é¢˜éš¾åº¦åˆ†ç±»ç»Ÿè®¡

2. **ç†µæœ‰æ•ˆæ€§éªŒè¯**
   - ç†µä¼°è®¡ vs å®é™…æ­¥æ•°çš„ç›¸å…³æ€§
   - ç†µä¼°è®¡ vs äººå·¥éš¾åº¦è¯„åˆ†çš„ç›¸å…³æ€§

3. **å®šç†ä½¿ç”¨åˆ†æ**
   - ç»Ÿè®¡æ¯ä¸ªå®šç†çš„ä½¿ç”¨é¢‘ç‡
   - åˆ†æå®šç†é€‰æ‹©çš„å‡†ç¡®æ€§

4. **é”™è¯¯åˆ†æ**
   - åˆ†ç±»é”™è¯¯ç±»å‹ï¼ˆå®šç†é€‰æ‹©é”™è¯¯ã€ç¬¦å·æ‰§è¡Œé”™è¯¯ã€ç­”æ¡ˆæå–é”™è¯¯ï¼‰
   - æŠ½æ ·åˆ†æå…¸å‹é”™è¯¯æ¡ˆä¾‹

5. **æ¶ˆèå®éªŒ**
   - å»é™¤ä¿¡æ¯å¢ç›Š â†’ åªç”¨æ¨¡å‹é¢„æµ‹
   - å»é™¤ç†µä¼°è®¡ â†’ å›ºå®šæ¨ç†ç­–ç•¥
   - å®šç†åº“å¤§å°çš„å½±å“

#### ğŸ“¥ è¾“å…¥
```python
{
    "test_set": "Conic10K/conic10k/test.json",
    "model": trained_model,
    "reasoning_engine": solver
}
```

#### ğŸ“¤ è¾“å‡º
```python
{
    "overall_accuracy": 0.68,
    "accuracy_by_answer_type": {
        "simple_number": 0.78,
        "complex_number": 0.65,
        "equation": 0.58,
        "coordinate": 0.72
    },
    "entropy_correlation": {
        "pearson": 0.82,
        "spearman": 0.79
    },
    "theorem_usage": {
        "T1_ellipse_abc": 1523,
        "T4_eccentricity": 1205,
        ...
    },
    "error_analysis": {
        "theorem_selection_error": 45,
        "symbolic_execution_error": 28,
        "answer_extraction_error": 12
    },
    "avg_reasoning_steps": 4.8
}
```

#### âœ… éªŒæ”¶æ ‡å‡†
- [ ] å®Œæ•´çš„è¯„ä¼°æŠ¥å‘Š
- [ ] è‡³å°‘3ä¸ªæ¶ˆèå®éªŒ
- [ ] è‡³å°‘10ä¸ªè¯¦ç»†çš„æ¡ˆä¾‹åˆ†æ
- [ ] å¯è§†åŒ–å›¾è¡¨ï¼ˆç†µæ›²çº¿ã€å®šç†ä½¿ç”¨åˆ†å¸ƒç­‰ï¼‰

#### â±ï¸ é¢„è®¡æ—¶é—´
**1.5-2å‘¨**

#### ğŸ“‚ ä»£ç æ–‡ä»¶
- `src/evaluation.py`
- `src/analysis.py`
- `notebooks/results_analysis.ipynb`

---

## ğŸ“Š å…³é”®æŒ‡æ ‡æ±‡æ€»

| æ¨¡å— | å…³é”®æŒ‡æ ‡ | ç›®æ ‡å€¼ | è¯´æ˜ |
|------|---------|--------|------|
| æ¨¡å—0: å®šç†åº“ | æ¨¡å‹æ•°é‡ | 80ä¸ª | è¦†ç›–æ•°æ®é›†æ‰€æœ‰æ¨¡å‹ |
| æ¨¡å—1: çŠ¶æ€æ„é€  | è§£ææˆåŠŸç‡ | > 95% | fact_expressionsè§£æ |
| æ¨¡å—1: çŠ¶æ€æ„é€  | ç‰¹å¾å®Œæ•´æ€§ | 15ç»´ | AbstractStateç‰¹å¾æ•° |
| æ¨¡å—2: è®­ç»ƒæ•°æ® | è®­ç»ƒæ ·æœ¬æ•° | 50,000+ | çŠ¶æ€-æ¨¡å‹å¯¹ |
| æ¨¡å—2: è®­ç»ƒæ•°æ® | éªŒè¯æ ·æœ¬æ•° | 10,000+ | ç”¨äºæ¨¡å‹éªŒè¯ |
| æ¨¡å—3: ç¥ç»ç½‘ç»œ | P(Y\|X) Top-1å‡†ç¡®ç‡ | > 60% | æ¨¡å‹é€‰æ‹©å‡†ç¡®ç‡ |
| æ¨¡å—3: ç¥ç»ç½‘ç»œ | P(Y\|X) Top-3å‡†ç¡®ç‡ | > 75% | Top-3è¦†ç›–ç‡ |
| æ¨¡å—3: ç¥ç»ç½‘ç»œ | H(S) MAE | < 0.15 | çŠ¶æ€ç†µä¼°è®¡è¯¯å·® |
| æ¨¡å—3: ç¥ç»ç½‘ç»œ | H(S) ç›¸å…³ç³»æ•° | > 0.7 | ä¸å®Œæ•´åº¦çš„ç›¸å…³æ€§ |
| æ¨¡å—5: æ¨ç†å¼•æ“ | ç«¯åˆ°ç«¯å‡†ç¡®ç‡ | **60-80%** | æ ¸å¿ƒç›®æ ‡ |
| æ¨¡å—5: æ¨ç†å¼•æ“ | å¹³å‡æ¨ç†æ­¥æ•° | < 6æ­¥ | æ•ˆç‡æŒ‡æ ‡ |
| æ¨¡å—5: æ¨ç†å¼•æ“ | ç†µå•è°ƒé€’å‡ç‡ | > 90% | è¯æ˜ç†µå¼•å¯¼æœ‰æ•ˆæ€§ |
| æ¨¡å—6: åˆ†æ | InfoGainæœ‰æ•ˆæ€§ | æ˜¾è‘—ç›¸å…³ | æ¶ˆèå®éªŒéªŒè¯ |

---

## ğŸ¯ é‡Œç¨‹ç¢‘æ£€æŸ¥ç‚¹

### âœ… Milestone 1 
- [ ] 15ä¸ªåŸºç¡€å®šç†å®ç°å®Œæˆ
- [ ] çŠ¶æ€æŠ½è±¡å™¨éªŒè¯é€šè¿‡
- [ ] å®šç†åº”ç”¨å™¨æ ¸å¿ƒåŠŸèƒ½å®Œæˆ

### âœ… Milestone 2 
- [ ] è®­ç»ƒæ•°æ®æ„é€ å®Œæˆ
- [ ] ç¥ç»ç½‘ç»œè®­ç»ƒå®Œæˆ
- [ ] æ¨¡å‹æ€§èƒ½è¾¾æ ‡ï¼ˆå®šç†é€‰æ‹©>70%ï¼‰

### âœ… Milestone 3 
- [ ] ç«¯åˆ°ç«¯ç³»ç»Ÿé›†æˆå®Œæˆ
- [ ] æµ‹è¯•é›†å‡†ç¡®ç‡>60%
- [ ] å®Œæ•´è¯„ä¼°æŠ¥å‘Š

### âœ… Milestone 4 
- [ ] è®ºæ–‡åˆç¨¿å®Œæˆ
- [ ] æ‰€æœ‰å®éªŒå®Œæˆ
- [ ] ä»£ç æ•´ç†å’Œæ–‡æ¡£å®Œå–„

---

## ğŸ“‚ é¡¹ç›®ç›®å½•ç»“æ„

```
EGR/
â”œâ”€â”€ Conic10K/                    # Conic10Kæ•°æ®é›†ï¼ˆåŸå§‹ï¼‰
â”‚   â””â”€â”€ conic10k/
â”‚       â”œâ”€â”€ train.json
â”‚       â”œâ”€â”€ dev.json
â”‚       â””â”€â”€ test.json
â”‚
â”œâ”€â”€ data/                        # æœ¬é¡¹ç›®å¤„ç†çš„æ•°æ®
â”‚   â”œâ”€â”€ train.json               # åŸå§‹è®­ç»ƒé›†
â”‚   â”œâ”€â”€ train_process.txt        # æå–çš„processå­—æ®µ
â”‚   â”œâ”€â”€ train_with_models_v2.json  # é›†æˆmodelså­—æ®µçš„è®­ç»ƒé›†
â”‚   â””â”€â”€ train_with_models_1_100.json  # å‰100æ¡æ ·æœ¬ï¼ˆç”¨äºæµ‹è¯•ï¼‰
â”‚
â”œâ”€â”€ model/                       # å®šç†æ¨¡å‹å®šä¹‰æ–‡æ¡£ï¼ˆå‚è€ƒèµ„æ–™ï¼‰
â”‚   â”œâ”€â”€ conic_model_ids.json     # 80ä¸ªæ¨¡å‹IDæ˜ å°„
â”‚   â”œâ”€â”€ conic_model_descriptions.md  # æ¨¡å‹è¯¦ç»†æè¿°
â”‚   â”œâ”€â”€ object.json              # å¯¹è±¡å®šä¹‰
â”‚   â””â”€â”€ operators.json           # æ“ä½œç¬¦å®šä¹‰
â”‚
â”œâ”€â”€ src/                         # æºä»£ç 
â”‚   â”‚
â”‚   â”œâ”€â”€ state/                   # æ¨¡å—1: çŠ¶æ€æ„é€ ä¸ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ symbolic_state.py    # SymbolicStateç±»
â”‚   â”‚   â”œâ”€â”€ abstract_state.py    # AbstractStateç±»
â”‚   â”‚   â”œâ”€â”€ state_constructor.py # çŠ¶æ€æ„é€ å™¨ï¼ˆä¸»å…¥å£ï¼‰
â”‚   â”‚   â”œâ”€â”€ parser.py            # fact_expressionsè§£æå™¨
â”‚   â”‚   â””â”€â”€ feature_extractor.py # æŠ½è±¡ç‰¹å¾æå–å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ theorems/                # æ¨¡å—0: å®šç†æ¨¡å‹åº“
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ theorem_library.py   # TheoremLibraryç±»ï¼ˆæ¨¡å‹ç®¡ç†ï¼‰
â”‚   â”‚   â”œâ”€â”€ base_model.py        # TheoremModelåŸºç±»
â”‚   â”‚   â”œâ”€â”€ models/              # 80ä¸ªå…·ä½“æ¨¡å‹å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ model_000.py     # æ¤­åœ†å‚æ•°å…³ç³»
â”‚   â”‚   â”‚   â”œâ”€â”€ model_001.py
â”‚   â”‚   â”‚   â”œâ”€â”€ ...
â”‚   â”‚   â”‚   â””â”€â”€ model_079.py
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â”œâ”€â”€ precondition_checker.py  # å‰ç½®æ¡ä»¶æ£€æŸ¥å·¥å…·
â”‚   â”‚       â””â”€â”€ symbolic_calc.py         # ç¬¦å·è®¡ç®—è¾…åŠ©å‡½æ•°
â”‚   â”‚
â”‚   â”œâ”€â”€ data/                    # æ¨¡å—2: è®­ç»ƒæ•°æ®æ„é€ 
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ data_constructor.py  # æ•°æ®æ„é€ å™¨ï¼ˆä¸»å…¥å£ï¼‰
â”‚   â”‚   â”œâ”€â”€ sequence_builder.py  # çŠ¶æ€åºåˆ—æ„å»º
â”‚   â”‚   â”œâ”€â”€ sample_generator.py  # è®­ç»ƒæ ·æœ¬ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ data_augmentation.py # æ•°æ®å¢å¼ºï¼ˆå¯é€‰ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                  # æ¨¡å—3: ç¥ç»ç½‘ç»œæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ max_entropy_model.py # ä¸»æ¨¡å‹ï¼šP(Y|X) + H(S)
â”‚   â”‚   â”œâ”€â”€ state_encoder.py     # AbstractStateç¼–ç å™¨
â”‚   â”‚   â”œâ”€â”€ classifier_head.py   # P(Y|X)åˆ†ç±»å¤´
â”‚   â”‚   â”œâ”€â”€ entropy_head.py      # H(S)å›å½’å¤´
â”‚   â”‚   â”œâ”€â”€ train.py             # è®­ç»ƒè„šæœ¬
â”‚   â”‚   â””â”€â”€ config.py            # æ¨¡å‹é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ reasoning/               # æ¨¡å—5: æ¨ç†å¼•æ“
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ reasoning_engine.py  # ç†µé©±åŠ¨æ¨ç†å¼•æ“ï¼ˆä¸»å…¥å£ï¼‰
â”‚   â”‚   â”œâ”€â”€ model_selector.py    # æ¨¡å‹é€‰æ‹©ç­–ç•¥
â”‚   â”‚   â”œâ”€â”€ entropy_calculator.py # ç†µä¸ä¿¡æ¯å¢ç›Šè®¡ç®—
â”‚   â”‚   â”œâ”€â”€ answer_extractor.py  # ç­”æ¡ˆæå–
â”‚   â”‚   â””â”€â”€ search_strategy.py   # æœç´¢ç­–ç•¥ï¼ˆè´ªå¿ƒ/beam searchï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ evaluation/              # æ¨¡å—6: è¯„ä¼°åˆ†æ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ evaluator.py         # è¯„ä¼°å™¨ï¼ˆä¸»å…¥å£ï¼‰
â”‚   â”‚   â”œâ”€â”€ metrics.py           # è¯„ä¼°æŒ‡æ ‡è®¡ç®—
â”‚   â”‚   â”œâ”€â”€ ablation.py          # æ¶ˆèå®éªŒ
â”‚   â”‚   â”œâ”€â”€ case_analysis.py     # æ¡ˆä¾‹åˆ†æ
â”‚   â”‚   â””â”€â”€ visualizer.py        # å¯è§†åŒ–å·¥å…·
â”‚   â”‚
â”‚   â””â”€â”€ utils/                   # é€šç”¨å·¥å…·
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ logger.py            # æ—¥å¿—å·¥å…·
â”‚       â”œâ”€â”€ file_io.py           # æ–‡ä»¶è¯»å†™
â”‚       â””â”€â”€ math_utils.py        # æ•°å­¦è®¡ç®—å·¥å…·
â”‚
â”œâ”€â”€ scripts/                     # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ build_state_sequences.py  # æ„å»ºçŠ¶æ€åºåˆ—
â”‚   â”‚   â””â”€â”€ preprocess_data.py        # æ•°æ®é¢„å¤„ç†
â”‚   â”œâ”€â”€ analysis/
â”‚   â”‚   â”œâ”€â”€ analyze_models.py         # æ¨¡å‹ä½¿ç”¨ç»Ÿè®¡
â”‚   â”‚   â””â”€â”€ analyze_states.py         # çŠ¶æ€åˆ†å¸ƒåˆ†æ
â”‚   â””â”€â”€ train/
â”‚       â””â”€â”€ train_model.sh            # è®­ç»ƒè„šæœ¬
â”‚
â”œâ”€â”€ tests/                       # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ state/
â”‚   â”‚   â”œâ”€â”€ test_symbolic_state.py
â”‚   â”‚   â”œâ”€â”€ test_abstract_state.py
â”‚   â”‚   â””â”€â”€ test_state_constructor.py
â”‚   â”œâ”€â”€ theorems/
â”‚   â”‚   â”œâ”€â”€ test_theorem_library.py
â”‚   â”‚   â”œâ”€â”€ test_base_model.py
â”‚   â”‚   â””â”€â”€ test_models/
â”‚   â”‚       â”œâ”€â”€ test_model_000.py
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”œâ”€â”€ integration/
â”‚   â”‚   â””â”€â”€ test_integration_state_theorem.py
â”‚   â”œâ”€â”€ reasoning/
â”‚   â”‚   â””â”€â”€ test_reasoning_engine.py
â”‚   â””â”€â”€ models/
â”‚       â””â”€â”€ test_max_entropy_model.py
â”‚
â”œâ”€â”€ configs/                     # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ model_config.yaml        # ç¥ç»ç½‘ç»œæ¨¡å‹é…ç½®
â”‚   â”œâ”€â”€ training_config.yaml     # è®­ç»ƒé…ç½®
â”‚   â””â”€â”€ reasoning_config.yaml    # æ¨ç†å¼•æ“é…ç½®
â”‚
â”œâ”€â”€ outputs/                     # è¾“å‡ºç»“æœ
â”‚   â”œâ”€â”€ models/                  # è®­ç»ƒå¥½çš„æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ checkpoints/
â”‚   â”‚   â””â”€â”€ best_model.pt
â”‚   â”œâ”€â”€ results/                 # è¯„ä¼°ç»“æœ
â”‚   â”‚   â”œâ”€â”€ test_results.json
â”‚   â”‚   â””â”€â”€ ablation_results.json
â”‚   â”œâ”€â”€ logs/                    # æ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ training.log
â”‚   â”‚   â””â”€â”€ evaluation.log
â”‚   â””â”€â”€ visualizations/          # å¯è§†åŒ–å›¾è¡¨
â”‚       â”œâ”€â”€ entropy_trace.png
â”‚       â””â”€â”€ accuracy_by_type.png
â”‚
â”œâ”€â”€ notebooks/                   # Jupyter notebooks
â”‚   â”œâ”€â”€ data_analysis.ipynb      # æ•°æ®åˆ†æ
â”‚   â”œâ”€â”€ model_analysis.ipynb     # æ¨¡å‹åˆ†æ
â”‚   â””â”€â”€ results_visualization.ipynb  # ç»“æœå¯è§†åŒ–
â”‚
â”œâ”€â”€ doc/                         # æ–‡æ¡£
â”‚   â”œâ”€â”€ project_workflow.md      # é¡¹ç›®æµç¨‹ï¼ˆæœ¬æ–‡æ¡£ï¼‰
â”‚   â”œâ”€â”€ module0_model_library.md # æ¨¡å—0å¼€å‘æŒ‡å—
â”‚   â”œâ”€â”€ module1_state_construct.md  # æ¨¡å—1å¼€å‘æŒ‡å—
â”‚   â”œâ”€â”€ åˆ›æ–°ç‚¹+è®ºæ–‡æ€è·¯.md       # è®ºæ–‡å†™ä½œæŒ‡å—
â”‚   â”œâ”€â”€ project_structure.md     # é¡¹ç›®ç»“æ„è¯´æ˜
â”‚   â”œâ”€â”€ quick_reference.md       # å¿«é€Ÿå‚è€ƒ
â”‚   â””â”€â”€ paper_structure.md       # è®ºæ–‡ç»“æ„è§„åˆ’
â”‚
â”œâ”€â”€ handbook/                    # å‚è€ƒæ‰‹å†Œ
â”‚   â”œâ”€â”€ Conic10K/
â”‚   â”‚   â”œâ”€â”€ conic10k_dataset_QA.md
â”‚   â”‚   â”œâ”€â”€ object.json
â”‚   â”‚   â””â”€â”€ operators.json
â”‚   â””â”€â”€ EGR/
â”‚       â”œâ”€â”€ EGR_idea.md
â”‚       â””â”€â”€ modules_quick_reference.md
â”‚
â”œâ”€â”€ requirements.txt             # Pythonä¾èµ–
â”œâ”€â”€ setup.py                     # å®‰è£…è„šæœ¬
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â””â”€â”€ .gitignore                   # Gitå¿½ç•¥é…ç½®
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—

### æ­¥éª¤1: ç¯å¢ƒé…ç½®
```bash
# å®‰è£…ä¾èµ–
pip install torch transformers numpy scipy sympy pandas

# éªŒè¯æ•°æ®é›†
python scripts/verify_dataset.py
```

### æ­¥éª¤2: è¿è¡Œæ•°æ®åˆ†æï¼ˆæ¨¡å—0çš„ç¬¬ä¸€æ­¥ï¼‰
```bash
python src/theorems/analyze_reasoning_patterns.py \
    --data Conic10K/conic10k/train.json \
    --output outputs/theorem_statistics.json
```

### æ­¥éª¤3: å®ç°ç¬¬ä¸€ä¸ªå®šç†
```bash
# å‚è€ƒ src/theorems/basic_theorems.py
# å®ç° T5_extract_params å®šç†
```

### æ­¥éª¤4: æµ‹è¯•çŠ¶æ€æŠ½è±¡å™¨
```bash
python tests/test_state_abstractor.py
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [å®šç†åº“è¯¦ç»†è§„èŒƒ](theorem_library_spec.md)
- [çŠ¶æ€è¡¨ç¤ºè®¾è®¡æ–‡æ¡£](state_representation.md)
- [æ¨¡å‹æ¶æ„è¯´æ˜](model_architecture.md)
- [å®éªŒè®¾ç½®ä¸è¶…å‚æ•°](experiment_setup.md)

---

## ğŸ’¡ æ³¨æ„äº‹é¡¹

### å…³äºåˆ›æ–°æ€§
1. **æœ€å¤§ç†µåŸç†çš„ä¸‰å±‚åº”ç”¨**æ˜¯æ ¸å¿ƒç†è®ºåˆ›æ–°ï¼Œéœ€è¦åœ¨è®ºæ–‡ä¸­è¯¦ç»†é˜è¿°
2. **çŠ¶æ€æŠ½è±¡**æ˜¯å·¥ç¨‹åˆ›æ–°ï¼Œéœ€è¦è¯æ˜æœ‰é™çŠ¶æ€çš„æœ‰æ•ˆæ€§
3. **ç†µé©±åŠ¨æ¨ç†**æ˜¯æ–¹æ³•åˆ›æ–°ï¼Œéœ€è¦é€šè¿‡æ¶ˆèå®éªŒè¯æ˜å…¶ä»·å€¼

### å…³äºå·¥ç¨‹å®ç°
1. ä¼˜å…ˆå®ç°æœ€å¸¸ç”¨çš„15ä¸ªå®šç†ï¼Œç¡®ä¿åŸºç¡€åŠŸèƒ½å¯ç”¨
2. çŠ¶æ€æŠ½è±¡çš„è®¾è®¡ç›´æ¥å½±å“åç»­æ‰€æœ‰æ¨¡å—ï¼Œéœ€è¦è°¨æ…è®¾è®¡
3. ç¥ç»ç½‘ç»œå¯ä»¥å…ˆç”¨å°æ¨¡å‹å¿«é€ŸéªŒè¯ï¼Œå†æ‰©å¤§è§„æ¨¡

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2026-01-15  
**æ›´æ–°å†…å®¹**: 
- æ›´æ–°æ¨¡å—0ä¸º80ä¸ªå½¢å¼åŒ–æ¨¡å‹
- æ›´æ–°æ¨¡å—1ä¸ºåŒå±‚çŠ¶æ€ï¼ˆSymbolicState + AbstractStateï¼‰
- æ˜ç¡®ä¸‰ä¸ªå…³é”®è®¡ç®—ï¼šP(Y|X), H(S), H(Y|X)çš„å®ç°æ–¹æ³•
- å®Œå–„ç†µé©±åŠ¨æ¨ç†çš„ç»¼åˆè¯„åˆ†å…¬å¼
- æ›´æ–°æ‰€æœ‰æ¨¡å—çš„æ¥å£å’Œå·¥ä½œæµç¨‹

